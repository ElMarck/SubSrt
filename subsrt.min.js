function tosec(t){return 3600*parseFloat(t.split(":")[0])+60*parseFloat(t.split(":")[1])+parseFloat(t.split(":")[2].replace(",","."))}window.onload=function(){var t=document.getElementsByTagName("video");[].forEach.call(t,function(t){t.loadTrack()})},HTMLVideoElement.prototype.loadTrack=function(){var t=this;[].forEach.call(this.getElementsByTagName("track"),function(e){if(".srt"==e.src.substr(e.src.length-4)){var r=new XMLHttpRequest;r.onreadystatechange=function(){4==r.readyState&&200==r.status&&t.createTrack(r.responseText,e)},r.open("GET",e.src,!0),r.send()}})},HTMLVideoElement.prototype.createTrack=function(t,e){var r=[],a=t.split("\n");a.push("\n");for(var n=0,o="",s=0==a[0].trim().length?1:0;s<a.length;s++){for(var i=s+2;i<a.length;i++){if(o+=a[i],0==a[i+1].trim().length){var c=tosec(a[s+1].split(" --> ")[0]),l=tosec(a[s+1].split(" --> ")[1]);r[n]={s:c,e:l,text:o},s=i+1;break}o+="\n"}o="",n++}var d=e.hasAttribute("default")?"showing":"hidden";e.track.mode="disabled";var u=this.addTextTrack(e.kind,e.label,e.srclang),h=navigator.userAgent.indexOf("MSIE");if(h=navigator.userAgent.match(/Trident\/7\./)?11:h,u.mode=d,this.removeChild(e),-1!=h)for(var T=0;T<r.length;T++)u.addCue(new TextTrackCue(r[T].s,r[T].e,r[T].text)),u.cues[T].line=-3;else for(var T=0;T<r.length;T++)u.addCue(new VTTCue(r[T].s,r[T].e,r[T].text)),u.cues[T].line=-3;u.mode="hidden",u.mode=d},HTMLVideoElement.prototype.addSrtUrl=function(t,e,r,a){track=document.createElement("track"),track.setAttribute("src",t),track.setAttribute("label",void 0==e?"New Track":e),track.setAttribute("srclang",void 0==r?" ":r),track.setAttribute("kind",void 0==a?" ":a),this.appendChild(track),this.loadTrack()},HTMLVideoElement.prototype.getTrack=function(t){for(var e=0;e<this.textTracks.length;e++)if(this.textTracks[e].label.toLowerCase()===t.toLowerCase())return this.textTracks[e]};
